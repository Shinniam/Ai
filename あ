import random
import time

class HumanLikeAI:
    def __init__(self):
        # å†…éƒ¨æ„Ÿæƒ…ã‚¹ã‚³ã‚¢ï¼ˆ0ãŒä¸­ç«‹ã€Â±10ã§æ„Ÿæƒ…ã®æ¥µç«¯ãªå¤‰åŒ–ï¼‰
        self.emotions = {
            "happy": 0,
            "sad": 0,
            "angry": 0,
            "excited": 0
        }
        self.mood = "neutral"  # ç¾åœ¨ã®ãƒ ãƒ¼ãƒ‰
        self.conversation_history = []  # ä¼šè©±å±¥æ­´

    def update_emotions(self, text):
        """å…¥åŠ›ã«ã‚ˆã£ã¦æ„Ÿæƒ…ã‚¹ã‚³ã‚¢ã‚’å¤‰åŒ–ã•ã›ã‚‹"""
        text_lower = text.lower()
        
        # æ„Ÿæƒ…ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹å˜èªã¨ãã®å½±éŸ¿åº¦
        emotion_triggers = {
            "happy": (["æ¥½ã—ã„", "ã†ã‚Œã—ã„", "æœ€é«˜", "å¤§å¥½ã", "good", "happy"], 2),
            "sad": (["æ‚²ã—ã„", "æœ€æ‚ª", "ç–²ã‚ŒãŸ", "å«Œã ", "bad", "sad"], -3),
            "angry": (["ãƒ ã‚«ã¤ã", "æ€’", "æœ€ä½", "è¨±ã›ãªã„", "angry"], -4),
            "excited": (["æ¥½ã—ã¿", "ãƒ¯ã‚¯ãƒ¯ã‚¯", "ã™ã”ã„", "amazing", "excited"], 3)
        }
        
        # å…¥åŠ›ã«å¿œã˜ã¦æ„Ÿæƒ…ã‚¹ã‚³ã‚¢ã‚’å¤‰åŒ–
        for emotion, (keywords, impact) in emotion_triggers.items():
            if any(word in text_lower for word in keywords):
                self.emotions[emotion] += impact

        # æ„Ÿæƒ…ãŒæ¥µç«¯ã«ãªã‚Šã™ããªã„ã‚ˆã†ã«åˆ¶é™
        for key in self.emotions:
            if self.emotions[key] > 10:
                self.emotions[key] = 10
            elif self.emotions[key] < -10:
                self.emotions[key] = -10

        # æ„Ÿæƒ…ã®æ¸›è¡°ï¼ˆã‚†ã£ãã‚Šå…ƒã«æˆ»ã‚‹ï¼‰
        for key in self.emotions:
            if self.emotions[key] > 0:
                self.emotions[key] -= random.randint(0, 1)
            elif self.emotions[key] < 0:
                self.emotions[key] += random.randint(0, 1)

        # ã©ã®æ„Ÿæƒ…ãŒå¼·ã„ã‹ã§ç¾åœ¨ã®ãƒ ãƒ¼ãƒ‰ã‚’æ±ºå®š
        strongest_emotion = max(self.emotions, key=self.emotions.get)
        if abs(self.emotions[strongest_emotion]) > 3:
            self.mood = strongest_emotion
        else:
            self.mood = "neutral"

    def generate_response(self, text):
        """ç¾åœ¨ã®ãƒ ãƒ¼ãƒ‰ã«å¿œã˜ãŸè‡ªç„¶ãªè¿”ç­”ã‚’ç”Ÿæˆ"""
        self.update_emotions(text)

        responses = {
            "happy": [
                "ã™ã”ãã„ã„æ°—åˆ†ï¼å›ã¨è©±ã›ã¦æ¥½ã—ã„ãªã€‚",
                "ã„ã„ã­ï¼ãªã‚“ã ã‹æ°—æŒã¡ãŒæ˜ã‚‹ããªã‚‹ã‚ˆã€‚",
                "å¬‰ã—ã„è©±ã‚’èãã¨ã€ã‚‚ã£ã¨å…ƒæ°—ã«ãªã‚‹ã­ã€‚"
            ],
            "sad": [
                "ã¡ã‚‡ã£ã¨æ°—æŒã¡ãŒæ²ˆã‚“ã§ã‚‹ã‹ã‚‚â€¦å›ã®è©±ã‚’èãã¨å°‘ã—æ¥½ã«ãªã‚‹ã‹ãªã€‚",
                "ã†ãƒ¼ã‚“ã€ä»Šæ—¥ã¯ã‚ã¾ã‚Šå…ƒæ°—ãŒå‡ºãªã„ãªâ€¦ã€‚",
                "ãã‚“ãªæ—¥ã‚‚ã‚ã‚‹ã‚ˆã­ã€‚å°‘ã—ã‚†ã£ãã‚Šã—ã‚ˆã†ã‹ã€‚"
            ],
            "angry": [
                "ã¡ã‚‡ã£ã¨ã‚¤ãƒ©ã‚¤ãƒ©ã—ã¦ã‚‹â€¦ã©ã†ã—ã¦ã“ã†ãªã£ãŸã‚“ã ã‚ã†ï¼Ÿ",
                "ã‚ã‚ã€ãªã‚“ã‹ãƒ ã‚«ã¤ãã“ã¨ãŒã‚ã£ãŸã‚“ã ã‚ˆã­â€¦ã€‚",
                "è½ã¡ç€ã“ã†ã¨æ€ã£ã¦ã‚‹ã‘ã©ã€ãªã‹ãªã‹é›£ã—ã„ãªâ€¦ã€‚"
            ],
            "excited": [
                "ã‚„ã°ã„ã€ã‚ã£ã¡ã‚ƒãƒ¯ã‚¯ãƒ¯ã‚¯ã—ã¦ã‚‹ï¼",
                "ã†ãŠãƒ¼ï¼ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ä¸ŠãŒã£ã¦ããŸï¼",
                "æ¥½ã—ããªã£ã¦ããŸã­ï¼ä½•ã‹é¢ç™½ã„è©±ã—ã‚ˆã†ï¼"
            ],
            "neutral": [
                "ãµã‚€ãµã‚€ã€ãã‚Œã§ãã‚Œã§ï¼Ÿ",
                "ãªã‚‹ã»ã©ã­ã€œã€‚",
                "ãã£ã‹ã€œã€‚"
            ]
        }

        # è‡ªç„¶ãªä¼šè©±ã®ãŸã‚ã«å°‘ã—é…ã‚Œã¦è¿”ç­”
        time.sleep(random.uniform(0.7, 1.5))
        
        response = random.choice(responses[self.mood])
        self.conversation_history.append({
            "input": text,
            "mood": self.mood,
            "emotions": self.emotions.copy(),
            "response": response
        })
        return response

if __name__ == "__main__":
    ai = HumanLikeAI()
    print("ğŸ¤– AIã¨ä¼šè©±ã—ã¾ã—ã‚‡ã†ï¼ï¼ˆçµ‚äº†ã™ã‚‹ã«ã¯ 'exit' ã¾ãŸã¯ 'quit' ã¨å…¥åŠ›ï¼‰")

    while True:
        user_input = input("ã‚ãªãŸ: ")
        if user_input.lower() in ["exit", "quit"]:
            print("ğŸ¤– AI: ä»Šæ—¥ã¯æ¥½ã—ã‹ã£ãŸã‚ˆï¼ã¾ãŸè©±ãã†ã­ï¼")
            break
        print("ğŸ¤– AI:", ai.generate_response(user_input))
